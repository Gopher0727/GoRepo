@base = http://localhost:8080
@json = application/json


### 1. 健康检查
GET {{base}}/health

### 2. 注册 (返回 201)
POST {{base}}/api/v1/auth/register
Content-Type: {{json}}

{
  "email": "alice@example.com",
  "name": "Alice",
  "password": "P@ssw0rd123"
}

### 3. 登录 (保存 token)
# @name login
POST {{base}}/api/v1/auth/login
Content-Type: {{json}}

{
  "email": "alice@example.com",
  "password": "P@ssw0rd123"
}

### 4. 检查是否需要 Rehash
GET {{base}}/api/v1/auth/rehash-check?email=alice@example.com

### 5. 创建条目 (需要授权)
POST {{base}}/api/v1/entries
Authorization: Bearer {{login.response.body.token}}
Content-Type: {{json}}

{
  "title": "GitHub",
  "username": "alice",
  "url": "https://github.com"
}

### 6. 列表条目
GET {{base}}/api/v1/entries
Authorization: Bearer {{login.response.body.token}}

### 7. 获取条目详情 (将 :id 替换为上一步返回的某个 id)
GET {{base}}/api/v1/entries/1
Authorization: Bearer {{login.response.body.token}}

### 8. 更新条目
PUT {{base}}/api/v1/entries/1
Authorization: Bearer {{login.response.body.token}}
Content-Type: {{json}}

{
  "title": "GitHub-Updated",
  "username": "alice_new",
  "url": "https://github.com/new"
}

### 9. 删除条目
DELETE {{base}}/api/v1/entries/1
Authorization: Bearer {{login.response.body.token}}

### 10. 加密示例（先生成 32 字节 key 并 base64：echo -n $(openssl rand -base64 32)）
# @name encrypt
POST {{base}}/api/v1/secure/encrypt
Authorization: Bearer {{login.response.body.token}}
Content-Type: {{json}}

{
  "key": "FuuVbJmlcQvznjjOlkDbjVo6yzuwe8yJl3JACukzQf8=",
  "plaintext": "hello secret"
}

### 11. 解密
POST {{base}}/api/v1/secure/decrypt
Authorization: Bearer {{login.response.body.token}}
Content-Type: {{json}}

{
  "key": "FuuVbJmlcQvznjjOlkDbjVo6yzuwe8yJl3JACukzQf8=",
  "ciphertext": "{{encrypt.response.body.ciphertext}}",
  "nonce": "{{encrypt.response.body.nonce}}"
}


##########################################################################

### fragment test
GET http://localhost:8080/url#frag HTTP/1.1

### POST test
POST http://localhost:8080/post  HTTP/1.1
Content-Type: application/json

{
    "name": "Sample",
    "time": {{$datetime rfc1123|iso8601 [offset option]}}
}

### arguments test
GET http://localhost:8080/arguments?id=1&name=Gopher&id=2 HTTP/1.1

###
POST /arguments HTTP/1.1
Host: localhost:8080
Content-Type: application/json

{
    "name": "Alice",
    "id": 1
}
